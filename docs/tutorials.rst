=====================
Tutorials
=====================

Electron spin polarization and transmission calculations can be carried out by
using the ``g4qt``, ``t4qt``, and ``qt`` scripts. The first two scripts prepare Gaussian and
Turbomole inputs,respectively, and run the programs to obtain data for transport 
calculations. The scripts can be run from the command line:

.. highlight:: bash

::

$ g4qt -h

 usage: g4qt [options]

    Read xyz file then run Gaussian 16 for transport data.


positional arguments:
  filename              input file

optional arguments:
  -h, --help            show this help message and exit
  -n NPROC, --nproc NPROC
                        Number of CPUs
  -b BASIS, --basis BASIS
                        Basis set
  -m METHOD, --method METHOD
                        Method
  -r RAM, --ram RAM     Memory in Mb

.. highlight:: bash

::

$ t4qt -h

usage: t4qt [options] 

    Read xyz file then run Turbomole's ridft for transport data.
    

positional arguments:
  filename              input file

optional arguments:
  -h, --help            show this help message and exit
  -n NPROC, --nproc NPROC
                        Number of CPUs
  -e, --ecp             add ECP group

The default settings in ``t4qt`` can overwritten by the user supplied in the `t19_params.json`
file. The keywords are given below.

========================== =============
keyword                    default       
========================== =============
use resolution of identity True
density functional         b3-lyp
basis set name             x2c-SVPall-2c 
total charge               0     
multiplicity               1 
use dft                    True     
scf iterations             400
========================== =============

The qt script performs the post-processing and the  electron spin polarization 
and transmissions functions for a given structure of a junction.  Results for spin
polarization and transmission functions are written in ``transmission.txt``. Here is
the help entry from the command line:

.. highlight:: bash

::

$ qt -h

usage: qt [options]

    Calculation of electron transport


positional arguments:
  filename            input file

optional arguments:
  -h, --help          show this help message and exit
  -soc SOC_TYPE, --soc_type SOC_TYPE
                        SOC for closed shell (CS) or open shell (OS)
  -db, --debug        debug print
  -l, --load_qt_dat   generated by the qt_dat script
  -fc, --fock_calc      calculate Fock matrices from MO energies and coeffs
  -p, --plot_spinpol  plot transmission.txt file

  -la LATOMS, --latoms LATOMS
                      left electrode atoms

  -ca CATOMS, --catoms CATOMS
                      central atoms
  -c CODE, --code CODE  g16 (Gaussian) or t24 (Turbomole)

output: percentage (spin polarization) of transmitted electron

Alternatively you can write your own python scripts which import ASE and 
QuantumTransport. The `/QuantumTransport` directory must be in your `$PYTHONPATH` 
(which it will be after installation) for example:

.. code-block:: python

    from QuantumTransport import TransportCal
    # # define output file
    filename = 'dft.out'
    # initialize class object to perform CISS calculations for closed shell (CS) 
    calc=TransportCal(filename, qccode='t24', soc_type='CS')
    calc.soc_transmission()


Settings
--------

The default settings for transport calculations. These settings can overwritten by
the user supplied in the `transport_params.json` file. The keywords are given below.

========= ======== ==============================================================
keyword   default  description
========= ======== ==============================================================
cLDOS     0.036    local density of states constant
Efermi    -5.0     Fermi energy used for transport calculation in eV
eini      -2.0     initial lower energy limit for the transmission function in eV
estep     0.01     step size of the transmissions function in eV
eend      -7.0     final energy limit for the transmission function in eV
========= ======== ==============================================================

The settings are in json format:
{"cLDOS": 0.036, "Efermi": -5.0, "eini":-7.0, "eend": -2.0, "estep": 0.01}

Examples
--------
In the example (in ``QuantumTransport/examples/dtda_g16`` directory) for oligo(p-phenyleneethynylene) (OPE) with a 1,2,3,5-dithiadiazolyl (DTDA) radical substituent (reported by Zöllner et al. [1]_) connected to nine-atomic gold electrodes/clusters. The calculated B3LYP/LANL2DZ transmission function for OPE-DTDA is shown in Figure 1.

.. figure:: ./_static/dtda.png
   :scale: 80 %

   Figure 1. Calculated transmission functions for the OPE-DTDA radical.

The B3LYP/LANL2DZ transmissions at the estimated Fermi energy of -5 eV for
DTDA and other radicals are listed below along with values reported by Zöllner et al.: [1]_

=======  ===================   ================
System   Zöllner et al. [1]_   QuantumTransport
=======  ===================   ================
DTDA     0.007                 0.0071
t-NO     0.006                 0.0057
NNO      0.003                 0.0030
Verdazl  0.004                 0.0042
OPE      0.008                 0.0071
=======  ===================   ================

The next example illustrates (Figure 2) first-principles calculations of the 
spin polarization in molecular junctions caused by the chiral induced spin 
selectivity (CISS) effect.  The B3LYP/x2c-SVPall-2c polarization function for 
the equidistant carbon helix between two 10-atom gold clusters compares well with 
values reported by Zöllner et al. [2]_ 

.. figure:: ./_static/equi_au_sw_t19.png
   :scale: 80 %

   Figure 2. B3LYP/x2c-SVPall-2c polarization function for the equidistant carbon helix between two 10-atom gold clusters compared with Zöllner et al. [2]_

References
----------

.. [1] Zöllner, M. S.; Nasri, R.; Zhang, H.; Herrmann, C. Design Considerations for Oligo(p‑phenyleneethynylene) Organic Radicals in Molecular Junctions. J. Phys. Chem. C 2021, 12,1208−1220.

.. [2]  Zöllner, M. S.; Saghatchi, A.; Mujica, V.; Herrmann, C., Influence of Electronic Structure Modeling and Junction Structure on First-Principles Chiral Induced Spin Selectivity. J. Chem. Theory Comput. 2020, 16 (12), 7357-7371.
